# PostsManager 컴포넌트 기능별 테스트 분석 정의서

## 1. 컴포넌트 개요

- **파일**: `src/pages/post/index.tsx`
- **컴포넌트명**: `PostsManager`
- **목적**: 게시물과 댓글을 관리하는 관리자 인터페이스
- **주요 기능**: CRUD 작업, 검색, 필터링, 정렬, 페이지네이션

## 2. 데이터 타입 정의

### 2.1 Comment 타입

```typescript
interface Comment {
  id: number
  body: string
  postId: number
  userId: number
  likes: number
  user: {
    username: string
  }
}
```

### 2.2 Post 타입

```typescript
interface Post {
  id: number
  title: string
  body: string
  userId: number
  tags?: string[]
  reactions?: {
    likes: number
    dislikes: number
  }
  author?: User
}
```

### 2.3 User 타입

```typescript
interface User {
  id: number
  username: string
  image: string
  firstName: string
  lastName: string
  age: number
  email: string
  phone: string
  address: {
    address: string
    city: string
    state: string
  }
  company: {
    name: string
    title: string
  }
}
```

### 2.4 Tag 타입

```typescript
interface Tag {
  url: string
  slug: string
}
```

## 3. 핵심 기능별 테스트 분석

### 3.1 게시물 목록 조회 기능

**기능 설명**: 게시물 목록을 페이지네이션과 함께 조회하고 사용자 정보를 포함하여 표시

**테스트 포인트**:

- 페이지네이션 파라미터(limit, skip)에 따른 게시물 조회
- 사용자 정보와 게시물 정보 병합
- 로딩 상태 관리
- 에러 처리 (네트워크 오류, API 오류)
- 전체 게시물 수 표시

**API 엔드포인트**:

- `GET /api/posts?limit=${limit}&skip=${skip}`
- `GET /api/users?limit=0&select=username,image`

**상태 변화**:

- `posts` 배열 업데이트
- `total` 값 설정
- `loading` 상태 변경

### 3.2 게시물 검색 기능

**기능 설명**: 제목과 내용을 기준으로 게시물을 검색하고 결과를 하이라이트하여 표시

**테스트 포인트**:

- 검색어 입력 시 Enter 키 이벤트 처리
- 빈 검색어일 때 전체 목록 조회
- 검색 결과 하이라이트 표시
- 검색 결과에서 사용자 정보 포함 여부
- 검색 중 로딩 상태 표시

**API 엔드포인트**:

- `GET /api/posts/search?q=${searchQuery}`

**상태 변화**:

- `posts` 배열 검색 결과로 업데이트
- `total` 값 검색 결과 수로 업데이트
- `loading` 상태 변경

### 3.3 태그별 필터링 기능

**기능 설명**: 특정 태그로 게시물을 필터링하여 표시

**테스트 포인트**:

- 태그 선택 시 해당 태그의 게시물만 표시
- "모든 태그" 선택 시 전체 게시물 표시
- 태그 클릭 시 즉시 필터 적용
- 태그별 게시물 수 표시
- 선택된 태그 시각적 표시

**API 엔드포인트**:

- `GET /api/posts/tag/${tag}`
- `GET /api/users?limit=0&select=username,image`

**상태 변화**:

- `selectedTag` 값 변경
- `posts` 배열 필터링된 결과로 업데이트
- `total` 값 필터링된 결과 수로 업데이트

### 3.4 게시물 추가 기능

**기능 설명**: 새로운 게시물을 생성하여 목록에 추가

**테스트 포인트**:

- 게시물 추가 다이얼로그 열기/닫기
- 제목, 내용, 사용자 ID 입력 폼 검증
- 필수 필드 검증 (제목, 내용)
- 게시물 추가 후 목록 맨 위에 표시
- 폼 초기화 (제목: "", 내용: "", 사용자 ID: 1)
- 다이얼로그 자동 닫기

**API 엔드포인트**:

- `POST /api/posts/add`

**상태 변화**:

- `newPost` 폼 데이터 관리
- `posts` 배열에 새 게시물 추가
- `showAddDialog` 상태 변경

### 3.5 게시물 수정 기능

**기능 설명**: 기존 게시물의 제목과 내용을 수정

**테스트 포인트**:

- 게시물 수정 다이얼로그 열기/닫기
- 선택된 게시물 정보 폼에 표시
- 제목, 내용 수정 가능
- 수정 후 목록에서 즉시 반영
- 다이얼로그 자동 닫기
- 선택된 게시물이 없을 때 처리

**API 엔드포인트**:

- `PUT /api/posts/${id}`

**상태 변화**:

- `selectedPost` 선택된 게시물 정보
- `posts` 배열에서 해당 게시물 업데이트
- `showEditDialog` 상태 변경

### 3.6 게시물 삭제 기능

**기능 설명**: 선택된 게시물을 목록에서 삭제

**테스트 포인트**:

- 삭제 버튼 클릭 시 즉시 삭제
- 삭제 후 목록에서 제거
- 삭제 확인 다이얼로그 없음 (즉시 삭제)
- 삭제 중 에러 처리

**API 엔드포인트**:

- `DELETE /api/posts/${id}`

**상태 변화**:

- `posts` 배열에서 해당 게시물 제거

### 3.7 댓글 조회 기능

**기능 설명**: 게시물별 댓글을 조회하고 캐싱하여 성능 최적화

**테스트 포인트**:

- 게시물 상세 보기 시 댓글 자동 로드
- 이미 로드된 댓글은 재요청하지 않음 (캐싱)
- 댓글 목록 표시 (작성자, 내용, 좋아요 수)
- 댓글이 없을 때 처리
- 댓글 로딩 중 에러 처리

**API 엔드포인트**:

- `GET /api/comments/post/${postId}`

**상태 변화**:

- `comments` 객체에 게시물별 댓글 저장

### 3.8 댓글 추가 기능

**기능 설명**: 게시물에 새로운 댓글을 추가

**테스트 포인트**:

- 댓글 추가 다이얼로그 열기/닫기
- 댓글 내용 입력 폼 검증
- 빈 댓글 입력 방지
- 댓글 추가 후 해당 게시물 댓글 목록에 추가
- 폼 초기화 (내용: "", 게시물 ID: null, 사용자 ID: 1)
- 다이얼로그 자동 닫기

**API 엔드포인트**:

- `POST /api/comments/add`

**상태 변화**:

- `newComment` 폼 데이터 관리
- `comments` 객체에 새 댓글 추가
- `showAddCommentDialog` 상태 변경

### 3.9 댓글 수정 기능

**기능 설명**: 기존 댓글의 내용을 수정

**테스트 포인트**:

- 댓글 수정 다이얼로그 열기/닫기
- 선택된 댓글 내용 폼에 표시
- 댓글 내용만 수정 가능
- 수정 후 목록에서 즉시 반영
- 다이얼로그 자동 닫기
- 선택된 댓글이 없을 때 처리

**API 엔드포인트**:

- `PUT /api/comments/${id}`

**상태 변화**:

- `selectedComment` 선택된 댓글 정보
- `comments` 객체에서 해당 댓글 업데이트
- `showEditCommentDialog` 상태 변경

### 3.10 댓글 삭제 기능

**기능 설명**: 선택된 댓글을 삭제

**테스트 포인트**:

- 삭제 버튼 클릭 시 즉시 삭제
- 삭제 후 댓글 목록에서 제거
- 삭제 확인 다이얼로그 없음 (즉시 삭제)
- 삭제 중 에러 처리

**API 엔드포인트**:

- `DELETE /api/comments/${id}`

**상태 변화**:

- `comments` 객체에서 해당 댓글 제거

### 3.11 댓글 좋아요 기능

**기능 설명**: 댓글의 좋아요 수를 증가

**테스트 포인트**:

- 좋아요 버튼 클릭 시 좋아요 수 증가
- 현재 좋아요 수 + 1로 업데이트
- 좋아요 수 즉시 반영
- 좋아요 중 에러 처리

**API 엔드포인트**:

- `PATCH /api/comments/${id}`

**상태 변화**:

- `comments` 객체에서 해당 댓글의 likes 수 증가

### 3.12 사용자 정보 조회 기능

**기능 설명**: 게시물 작성자의 상세 정보를 모달로 표시

**테스트 포인트**:

- 작성자 클릭 시 사용자 모달 열기
- 사용자 상세 정보 API 호출
- 프로필 이미지, 개인정보, 회사정보 표시
- 모달 닫기 기능
- 사용자 정보 로딩 중 에러 처리

**API 엔드포인트**:

- `GET /api/users/${id}`

**상태 변화**:

- `selectedUser` 선택된 사용자 정보
- `showUserModal` 상태 변경

### 3.13 태그 목록 조회 기능

**기능 설명**: 사용 가능한 모든 태그 목록을 조회

**테스트 포인트**:

- 컴포넌트 초기화 시 태그 목록 자동 로드
- 태그 선택 드롭다운에 태그 목록 표시
- 태그 로딩 중 에러 처리

**API 엔드포인트**:

- `GET /api/posts/tags`

**상태 변화**:

- `tags` 배열에 태그 목록 저장

### 3.14 URL 상태 동기화 기능

**기능 설명**: 검색, 필터, 정렬 상태를 URL에 반영하여 브라우저 히스토리 지원

**테스트 포인트**:

- 검색어 변경 시 URL 파라미터 업데이트
- 태그 선택 시 URL 파라미터 업데이트
- 정렬 기준/순서 변경 시 URL 파라미터 업데이트
- 페이지네이션 변경 시 URL 파라미터 업데이트
- URL 파라미터 변경 시 상태 동기화
- 브라우저 뒤로가기/앞으로가기 지원
- 새로고침 시 상태 유지

**상태 변화**:

- URL 파라미터와 상태 동기화
- `skip`, `limit`, `searchQuery`, `sortBy`, `sortOrder`, `selectedTag` 업데이트

### 3.15 하이라이트 기능

**기능 설명**: 검색어와 일치하는 텍스트를 하이라이트하여 표시

**테스트 포인트**:

- 검색어와 일치하는 텍스트 하이라이트
- 대소문자 무시 검색
- 정규식 기반 검색
- 텍스트가 undefined일 때 처리
- 검색어가 빈 문자열일 때 처리
- 게시물 제목, 내용, 댓글 내용에 하이라이트 적용

**상태 변화**:

- 하이라이트된 JSX 요소 반환

### 3.16 페이지네이션 기능

**기능 설명**: 게시물 목록을 페이지 단위로 나누어 표시

**테스트 포인트**:

- 이전/다음 버튼 클릭 시 페이지 변경
- 첫 페이지에서 이전 버튼 비활성화
- 마지막 페이지에서 다음 버튼 비활성화
- 페이지당 항목 수 선택 (10, 20, 30)
- 페이지 변경 시 URL 업데이트
- 페이지 변경 시 데이터 재조회

**상태 변화**:

- `skip` 값 변경
- `limit` 값 변경

### 3.17 정렬 기능

**기능 설명**: 게시물 목록을 다양한 기준으로 정렬

**테스트 포인트**:

- 정렬 기준 선택 (ID, 제목, 반응, 없음)
- 정렬 순서 선택 (오름차순, 내림차순)
- 정렬 변경 시 즉시 적용
- 정렬 변경 시 URL 업데이트
- 정렬 변경 시 데이터 재조회

**상태 변화**:

- `sortBy` 값 변경
- `sortOrder` 값 변경

### 3.18 게시물 상세 보기 기능

**기능 설명**: 게시물의 상세 내용과 댓글을 모달로 표시

**테스트 포인트**:

- 게시물 상세 보기 버튼 클릭 시 모달 열기
- 게시물 제목, 내용 표시
- 댓글 목록 표시
- 댓글 추가 버튼 기능
- 모달 닫기 기능
- 제목, 내용에 하이라이트 적용

**상태 변화**:

- `selectedPost` 선택된 게시물 정보
- `showPostDetailDialog` 상태 변경

## 4. UI 컴포넌트별 테스트 분석

### 4.1 메인 테이블 컴포넌트

**기능 설명**: 게시물 목록을 테이블 형태로 표시

**테스트 포인트**:

- 테이블 헤더 표시 (ID, 제목, 작성자, 반응, 작업)
- 게시물 행 데이터 표시
- 태그 표시 및 클릭 이벤트
- 작성자 정보 표시 및 클릭 이벤트
- 반응 수 표시 (좋아요, 싫어요)
- 작업 버튼 표시 (댓글보기, 수정, 삭제)
- 빈 목록 처리
- 로딩 상태 표시

### 4.2 댓글 섹션 컴포넌트

**기능 설명**: 게시물별 댓글 목록을 표시

**테스트 포인트**:

- 댓글 목록 표시
- 댓글 추가 버튼 표시
- 각 댓글의 작성자, 내용, 좋아요 수 표시
- 댓글 작업 버튼 표시 (좋아요, 수정, 삭제)
- 빈 댓글 목록 처리
- 댓글 내용 하이라이트

### 4.3 다이얼로그 컴포넌트들

**기능 설명**: 각종 작업을 위한 모달 다이얼로그

**테스트 포인트**:

- 게시물 추가 다이얼로그 (제목, 내용, 사용자 ID 입력)
- 게시물 수정 다이얼로그 (제목, 내용 수정)
- 댓글 추가 다이얼로그 (댓글 내용 입력)
- 댓글 수정 다이얼로그 (댓글 내용 수정)
- 게시물 상세 다이얼로그 (제목, 내용, 댓글 목록)
- 사용자 정보 다이얼로그 (프로필, 개인정보, 회사정보)
- 다이얼로그 열기/닫기 동작
- 폼 입력 검증

## 5. 에러 처리 테스트 분석

### 5.1 API 에러 처리

**기능 설명**: API 호출 실패 시 적절한 에러 처리

**테스트 포인트**:

- 네트워크 오류 처리
- API 응답 오류 처리
- 각 API 함수별 개별 에러 처리
- 에러 로깅 (console.error)
- 로딩 상태 해제 (finally 블록)

### 5.2 사용자 입력 검증

**기능 설명**: 사용자 입력 데이터의 유효성 검증

**테스트 포인트**:

- 필수 필드 검증 (제목, 내용)
- 빈 입력 방지
- 잘못된 데이터 타입 처리
- 폼 제출 전 검증

## 6. 성능 최적화 테스트 분석

### 6.1 댓글 캐싱

**기능 설명**: 이미 로드된 댓글을 재사용하여 성능 최적화

**테스트 포인트**:

- 동일한 게시물의 댓글 재요청 방지
- 캐시된 댓글 데이터 사용
- 댓글 추가/수정/삭제 시 캐시 업데이트

### 6.2 조건부 렌더링

**기능 설명**: 로딩 상태에 따른 조건부 렌더링

**테스트 포인트**:

- 로딩 중 로딩 표시
- 로딩 완료 시 실제 데이터 표시
- 에러 상태 표시

## 7. 테스트 케이스 우선순위

### 7.1 높은 우선순위 (핵심 기능)

1. 게시물 목록 조회 기능
2. 게시물 검색 기능
3. 게시물 추가/수정/삭제 기능
4. 댓글 조회/추가/수정/삭제 기능
5. 페이지네이션 기능

### 7.2 중간 우선순위 (부가 기능)

1. 태그별 필터링 기능
2. 정렬 기능
3. 사용자 정보 조회 기능
4. URL 상태 동기화 기능
5. 하이라이트 기능

### 7.3 낮은 우선순위 (UI/UX)

1. 다이얼로그 컴포넌트들
2. 댓글 좋아요 기능
3. 에러 처리
4. 성능 최적화
